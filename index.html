<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pedometer App</title>

<link rel="manifest" href="manifest.json">

<style>
body{
font-family: Arial, sans-serif;
margin:0;
background:#0f172a;
color:white;
text-align:center;
}

header{
padding:15px;
font-size:22px;
font-weight:bold;
background:#020617;
}

.container{
padding:20px;
}

.steps{
font-size:60px;
margin:20px 0;
font-weight:bold;
}

.distance{
font-size:22px;
margin-bottom:20px;
}

button, select{
padding:12px 18px;
margin:5px;
border:none;
border-radius:10px;
font-size:16px;
cursor:pointer;
}

button{
background:#22c55e;
color:white;
}

button:hover{
opacity:0.8;
}

canvas{
background:white;
border-radius:12px;
margin-top:20px;
}

.footer{
margin-top:15px;
font-size:14px;
opacity:0.7;
}
</style>
</head>

<body>

<header>ðŸ“± Pedometer App</header>

<div class="container">

<select id="unit">
<option value="km">Kilometers</option>
<option value="mi">Miles</option>
</select>

<div class="steps" id="steps">0</div>

<div class="distance" id="distance">0 km</div>

<button onclick="startTracking()">Start Walking</button>
<button onclick="resetSteps()">Reset</button>
<button onclick="shareResults()">Share</button>

<canvas id="chart" width="350" height="200"></canvas>

<div class="footer">
Tip: Add to Home Screen to install like an app
</div>

</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
let steps = 0;
let lastAccel = 0;
let unit = "km";

const stepsEl = document.getElementById("steps");
const distanceEl = document.getElementById("distance");

document.getElementById("unit").onchange = e=>{
unit = e.target.value;
updateDisplay();
};

function startTracking(){
if(typeof DeviceMotionEvent !== "undefined"){
window.addEventListener("devicemotion", motionHandler);
alert("Walking tracker started!");
}else{
alert("Motion tracking not supported.");
}
}

function motionHandler(e){
let accel = e.accelerationIncludingGravity;
let magnitude = Math.sqrt(accel.x*accel.x + accel.y*accel.y + accel.z*accel.z);

if(magnitude > 12 && lastAccel <= 12){
steps++;
saveToday();
updateDisplay();
}
lastAccel = magnitude;
}

function updateDisplay(){
stepsEl.textContent = steps;

let km = steps * 0.0008;
let dist = unit==="km" ? km : km*0.621371;

distanceEl.textContent = dist.toFixed(2) + " " + unit;
drawChart();
}

function resetSteps(){
steps = 0;
updateDisplay();
}

function getTodayKey(){
return "steps_"+new Date().toISOString().split("T")[0];
}

function saveToday(){
localStorage.setItem(getTodayKey(), steps);
}

function loadHistory(){
let data = {};
for(let i=0;i<30;i++){
let d = new Date();
d.setDate(d.getDate()-i);
let key = "steps_"+d.toISOString().split("T")[0];
data[d.toLocaleDateString()] = localStorage.getItem(key)||0;
}
return data;
}

let chart;
function drawChart(){
let history = loadHistory();
let labels = Object.keys(history).reverse();
let values = Object.values(history).reverse();

if(chart) chart.destroy();

chart = new Chart(document.getElementById("chart"), {
type:"line",
data:{
labels:labels,
datasets:[{
label:"Daily Steps",
data:values,
fill:false,
tension:0.3
}]
}
});
}

function shareResults(){
let text = `I walked ${steps} steps today! ðŸš¶`;

if(navigator.share){
navigator.share({title:"My Steps", text:text});
}else{
navigator.clipboard.writeText(text);
alert("Results copied to clipboard!");
}
}

steps = localStorage.getItem(getTodayKey()) || 0;
updateDisplay();
</script>

</body>
</html>
