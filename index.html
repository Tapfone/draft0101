<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pedometer App</title>

<style>
body{
    font-family: Arial, sans-serif;
    margin:0;
    background:#0f172a;
    color:white;
    text-align:center;
}

.container{
    padding:20px;
    max-width:500px;
    margin:auto;
}

h1{
    margin-bottom:10px;
}

.card{
    background:#1e293b;
    padding:20px;
    border-radius:20px;
    margin-top:15px;
}

.steps{
    font-size:60px;
    font-weight:bold;
}

.distance{
    font-size:28px;
    margin-top:10px;
}

button, select{
    padding:12px 18px;
    border:none;
    border-radius:12px;
    font-size:16px;
    margin:5px;
}

button{
    background:#22c55e;
    color:white;
    cursor:pointer;
}

button.secondary{
    background:#3b82f6;
}

button.danger{
    background:#ef4444;
}

footer{
    margin-top:20px;
    font-size:12px;
    opacity:.6;
}
</style>
</head>

<body>

<div class="container">

<h1>ðŸš¶ Pedometer</h1>

<div class="card">
    <div class="steps" id="steps">0</div>
    <div class="distance" id="distance">0 km</div>
</div>

<div class="card">
    <select id="unit">
        <option value="km">Kilometers</option>
        <option value="mi">Miles</option>
    </select>

    <br><br>

    <button onclick="start()">Start</button>
    <button class="danger" onclick="reset()">Reset</button>
</div>

<div class="card">
    <button class="secondary" onclick="shareResults()">Share Results</button>
</div>

<footer>
Move your phone while walking for best results
</footer>

</div>

<script>
let steps = Number(localStorage.getItem("steps")) || 0;
let lastMagnitude = 0;
let started = false;

const stepsEl = document.getElementById("steps");
const distanceEl = document.getElementById("distance");
const unitSelect = document.getElementById("unit");

function updateUI(){
    stepsEl.textContent = steps;

    let km = steps * 0.0008; // average step length
    let unit = unitSelect.value;

    if(unit === "mi"){
        distanceEl.textContent = (km * 0.621371).toFixed(2) + " miles";
    } else {
        distanceEl.textContent = km.toFixed(2) + " km";
    }

    localStorage.setItem("steps", steps);
}

updateUI();

function start(){
    if(!("DeviceMotionEvent" in window)){
        alert("Motion sensors not supported on this device");
        return;
    }

    if(typeof DeviceMotionEvent.requestPermission === "function"){
        DeviceMotionEvent.requestPermission()
        .then(response => {
            if(response === "granted") enableTracking();
        });
    } else {
        enableTracking();
    }
}

function enableTracking(){
    if(started) return;
    started = true;

    window.addEventListener("devicemotion", e => {
        let acc = e.accelerationIncludingGravity;
        let magnitude = Math.sqrt(acc.x*acc.x + acc.y*acc.y + acc.z*acc.z);

        if(Math.abs(magnitude - lastMagnitude) > 6){
            steps++;
            updateUI();
        }

        lastMagnitude = magnitude;
    });
}

function reset(){
    steps = 0;
    updateUI();
}

unitSelect.onchange = updateUI;

function shareResults(){
    let text = `I walked ${steps} steps (${distanceEl.textContent}) using my Pedometer App!`;

    if(navigator.share){
        navigator.share({
            title:"My Steps",
            text:text
        });
    } else {
        navigator.clipboard.writeText(text);
        alert("Results copied to clipboard!");
    }
}
</script>

</body>
</html>
